<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ â€” Ù…Ø¬Ù…ÙˆØ¹Ù‡ A</title>
<style>
  body{font-family:'Vazir', Tahoma, sans-serif;background:#f7fbff;margin:12px}
  .card{background:#fff;padding:18px;border-radius:10px;max-width:880px;margin:12px auto;box-shadow:0 8px 24px rgba(0,0,0,0.06)}
  h1{color:#0077cc;margin:0 0 8px}
  label{display:block;margin-top:10px;font-weight:600}
  select,input,button,textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #ccc;margin-top:6px;box-sizing:border-box;font-family:inherit}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  button{background:#0077cc;color:#fff;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
  button.ghost{background:#fff;color:#0077cc;border:1px solid #0077cc}
  .big{background:#ff9800;padding:12px 14px;font-weight:700}
  .box{margin-top:12px;padding:10px;border-radius:8px;background:#eef6ff;direction:ltr}
  .hidden{display:none}
  .danger{color:#b00020}
  svg text{font-size:13px;text-anchor:middle}
  .center{text-align:center}
  .muted{color:#666;font-size:13px;margin-top:8px}
</style>
</head>
<body>
  <div class="card">
    <h1>Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§</h1>
    <h2>Ù…Ø¬Ù…ÙˆØ¹Ù‡ A :</h2>

    <label>Û±) Ø¹Ø¶Ùˆ Ú©Ø¯Ø§Ù… Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” Ø´Ù†Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡ Ø§Ø³ØªØŸ</label>
    <select id="baseA">
      <option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
      <option value="N">â„• â€” Ø§Ø¹Ø¯Ø§Ø¯ Ø·Ø¨ÛŒØ¹ÛŒ</option>
      <option value="W">ğ• â€” Ø§Ø¹Ø¯Ø§Ø¯ Ø­Ø³Ø§Ø¨ÛŒ (Ø´Ø§Ù…Ù„ Û°)</option>
      <option value="Z">â„¤ â€” Ø§Ø¹Ø¯Ø§Ø¯ ØµØ­ÛŒØ­</option>
      <option value="Q">â„š â€” Ø§Ø¹Ø¯Ø§Ø¯ Ú¯ÙˆÛŒØ§</option>
      <option value="R">â„ â€” Ø§Ø¹Ø¯Ø§Ø¯ Ø­Ù‚ÛŒÙ‚ÛŒ</option>
      <option value="irr">Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯</option>
    </select>

    <div id="autoFormula" class="box">A Ù‡Ù†ÙˆØ² Ø³Ø§Ø®ØªÙ‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</div>

    <label>Û²) Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯ Ø´Ø±Ø·ØŒ Ø¢Ù† Ø±Ø§ Ø¨Ù‡ Ø²Ø¨Ø§Ù† Ú©Ù„Ø§Ù…ÛŒ Ø¨Ù†ÙˆÛŒØ³:</label>
    <input id="condA" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² 10 ÛŒØ§ Ø¨ÛŒÙ† 1 Ùˆ 5 ÛŒØ§ Ø²ÙˆØ¬">

    <div class="row">
      <button id="buildA">Ø³Ø§Ø®Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡ (Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´)</button>
      <button id="showMathA" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ù†Ù…Ø§Ø¯ Ø±ÛŒØ§Ø¶ÛŒ</button>
      <button id="showMembersA" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¶Ø§</button>
      <button id="showVennA" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø± ÙˆÙ†</button>
      <button id="showAxisA" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø±ÙˆÛŒ Ù…Ø­ÙˆØ±</button>
    </div>

    <div id="mathA" class="box hidden"></div>
    <div id="membersA" class="box hidden"></div>
    <div id="vennA" class="box hidden center"></div>
    <div id="axisA" class="box hidden"></div>

    <div class="muted">Ø§Ú¯Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ ÛŒØ§ Ø§Ø² Ù†ÙˆØ¹ â„š ÛŒØ§ â„ ÛŒØ§ Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯ Ø¨Ø§Ø´Ø¯ØŒ Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¶Ø§/ÙˆÙ†/Ù…Ø­ÙˆØ± Ø¨Ù‡ ØµÙˆØ±Øª ÙÙ‡Ø±Ø³Øª Ø¹Ø¯Ø¯ÛŒ Ø§Ù…Ú©Ø§Ù†â€ŒÙ¾Ø°ÛŒØ± Ù†ÛŒØ³Øª Ùˆ Ù¾ÛŒØºØ§Ù… Ù…Ù†Ø§Ø³Ø¨ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>

    <div class="row" style="margin-top:14px">
      <button id="goOps" class="big">Ø§Ù†Ø¬Ø§Ù… Ø¹Ù…Ù„ÛŒØ§Øª Ø±ÛŒØ§Ø¶ÛŒ â†’</button>
      <button id="saveLocal" class="ghost">Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± (Ù…ÙˆÙ‚Øª)</button>
    </div>
  </div>

<script>
/* ØªØ¨Ø¯ÛŒÙ„ Ø§Ø±Ù‚Ø§Ù… Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ */
function persian(n){ return String(n).replace(/[0-9]/g,d=>"Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹"[d]); }

/* Ù†Ù…ÙˆÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø§ÛŒÙ‡â€ŒÙ‡Ø§ */
const baseSamples = {
  N: (limit=20)=>Array.from({length:limit},(_,i)=>i+1),
  W: (limit=20)=>Array.from({length:limit},(_,i)=>i),
  Z: (limit=21)=>{ const a=[]; for(let i=-10;i<=10;i++) a.push(i); return a; },
  Q: ()=>null, R: ()=>null, irr: ()=>null
};

/* ØªØ¨Ø¯ÛŒÙ„ Ø´Ø±Ø· ÙØ§Ø±Ø³ÛŒ Ø¨Ù‡ Ø´ÛŒÙ” Ø´Ø±Ø· (Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬) */
function parsePersianCondition(t){
  const s = (t||'').trim().toLowerCase();
  if(!s) return {ok:false};
  let m;
  if(m=s.match(/Ø¨ÛŒÙ†\s*(-?\d+)\s*(?:Ùˆ|ØªØ§)\s*(-?\d+)/)){ const a=Number(m[1]), b=Number(m[2]); return {ok:true,predicate:x=>x>=Math.min(a,b)&&x<=Math.max(a,b),symbolic:`${Math.min(a,b)} \\le x \\le ${Math.max(a,b)}`,meta:{type:'interval',a:Math.min(a,b),b:Math.max(a,b),inclusiveBoth:true}};}
  if(m=s.match(/Ú©ÙˆÚ†Ú©ØªØ±\s*ÛŒØ§\s*Ù…Ø³Ø§ÙˆÛŒ\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x<=n,symbolic:`x \\le ${n}`,meta:{type:'lte',n, inclusive:true}};}
  if(m=s.match(/Ø¨Ø²Ø±Ú¯ØªØ±\s*ÛŒØ§\s*Ù…Ø³Ø§ÙˆÛŒ\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x>=n,symbolic:`x \\ge ${n}`,meta:{type:'gte',n, inclusive:true}};}
  if(m=s.match(/Ú©ÙˆÚ†Ú©ØªØ±\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x< n,symbolic:`x < ${n}`,meta:{type:'lt',n,inclusive:false}};}
  if(m=s.match(/Ø¨Ø²Ø±Ú¯ØªØ±\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x> n,symbolic:`x > ${n}`,meta:{type:'gt',n,inclusive:false}};}
  if(/\bØ²ÙˆØ¬\b/.test(s)) return {ok:true,predicate:x=>Number.isInteger(x)&&x%2===0,symbolic:`x \\text{ Ø²ÙˆØ¬}`,meta:{type:'parity',parity:'even'}};
  if(/\bÙØ±Ø¯\b/.test(s)) return {ok:true,predicate:x=>Number.isInteger(x)&&Math.abs(x%2)===1,symbolic:`x \\text{ ÙØ±Ø¯}`,meta:{type:'parity',parity:'odd'}};
  if(m=s.match(/ØªÙ‚Ø³ÛŒÙ…\s*Ø¨Ø±\s*(\d+)/)){const k=Number(m[1]);return {ok:true,predicate:x=>Number.isInteger(x)&&x%k===0,symbolic:`x \\equiv 0 \\ (mod\\ ${k})`,meta:{type:'div',k}};}
  if(m=s.match(/^(-?\d+)$/)){ const n=Number(m[1]); return {ok:true,predicate:x=>x===n,symbolic:`x = ${n}`,meta:{type:'equal',n}};}
  return {ok:false};
}

/* ÙˆØ¶Ø¹ÛŒØª A */
let A = { base:null, condText:'', symbolic:'', members:null, meta:null };

/* Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ */
const baseA = document.getElementById('baseA');
const condA = document.getElementById('condA');
const buildA = document.getElementById('buildA');
const autoFormula = document.getElementById('autoFormula');
const mathA = document.getElementById('mathA');
const membersA = document.getElementById('membersA');
const vennA = document.getElementById('vennA');
const axisA = document.getElementById('axisA');
const showMathA = document.getElementById('showMathA');
const showMembersA = document.getElementById('showMembersA');
const showVennA = document.getElementById('showVennA');
const showAxisA = document.getElementById('showAxisA');
const goOps = document.getElementById('goOps');
const saveLocal = document.getElementById('saveLocal');

/* Ø³Ø§Ø®Øª A */
function createA(){
  const base = baseA.value;
  const condText = condA.value.trim();
  if(!base){ alert('Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø´Ù†Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†'); return; }
  A.base = base; A.condText = condText;
  const parsed = condText ? parsePersianCondition(condText) : {ok:false};
  // symbolic
  if(base==='irr') A.symbolic = condText ? `A = { x âˆˆ Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯ | ${parsed.symbolic || condText} }` : `A = { x âˆˆ Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯ }`;
  else A.symbolic = condText ? `A = { x âˆˆ ${base} | ${parsed.symbolic || condText} }` : `A = { x âˆˆ ${base} }`;
  // members sample for N/W/Z
  if(['N','W','Z'].includes(base)){
    let sample = baseSamples;
    if(parsed.ok) A.members = sample.filter(parsed.predicate);
    else A.members = sample;
    A.meta = parsed.meta||null;
  } else {
    A.members = null;
    A.meta = parsed.meta||null;
  }
  autoFormula.innerHTML = `<strong>ÙØ±Ù…ÙˆÙ„ (Ø®Ù„Ø§ØµÙ‡):</strong> <div style="margin-top:6px;direction:ltr">${A.symbolic}</div>`;
  mathA.classList.add('hidden'); membersA.classList.add('hidden'); vennA.classList.add('hidden'); axisA.classList.add('hidden');
}

/* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
buildA.addEventListener('click', ()=>{ createA(); });
showMathA.addEventListener('click', ()=>{
  if(!A.symbolic){ alert('Ø§Ø¨ØªØ¯Ø§ Ù…Ø¬Ù…ÙˆØ¹Ù‡ A Ø±Ø§ Ø¨Ø³Ø§Ø²'); return; }
  mathA.classList.remove('hidden'); mathA.innerHTML = `<pre>${A.symbolic}</pre>`;
});
showMembersA.addEventListener('click', ()=>{
  membersA.classList.remove('hidden');
  if(!A.members){ membersA.innerHTML = `<div class="danger">Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø§ÛŒÙ†Ú©Ù‡ Ø¹Ø¶Ùˆ Ø§Ø¹Ø¯Ø§Ø¯ ${A.base==='Q'?'Ú¯ÙˆÛŒØ§':(A.base==='R'?'Ø­Ù‚ÛŒÙ‚ÛŒ':'Ú¯Ù†Ú¯')} Ø§Ø³ØªØŒ Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¶Ø§ Ø§Ù…Ú©Ø§Ù†â€ŒÙ¾Ø°ÛŒØ± Ù†ÛŒØ³Øª.</div>`; return; }
  membersA.innerHTML = `<div><strong>A = </strong>{ ${A.members.map(persian).join(', ')} }</div>`;
});
showVennA.addEventListener('click', ()=>{
  vennA.classList.remove('hidden');
  if(!A.members || A.members.length===0){ vennA.innerHTML = `<div class="danger">Ø§Ù…Ú©Ø§Ù† Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø± ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯ (Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ ÛŒØ§ ØºÛŒØ±Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´).</div>`; return; }
  // Ø±Ø³Ù… Ø¯Ø§ÛŒØ±Ù‡ Ùˆ Ù†ÙˆØ´ØªÙ† Ø§Ø¹Ø¶Ø§ Ø¯ÙˆØ± Ù…Ø­ÛŒØ·
  const members = A.members.slice(0,40);
  const cx=160, cy=90, r=70;
  let texts='';
  const step = 360/members.length;
  members.forEach((v,i)=>{
    const ang = (step*i - 90) * Math.PI/180;
    const x = cx + r*Math.cos(ang), y = cy + r*Math.sin(ang);
    texts += `<text x="${x}" y="${y+4}">${persian(v)}</text>`;
  });
  vennA.innerHTML = `<svg width="320" height="200"><circle cx="${cx}" cy="${cy}" r="${r}" stroke="#0077cc" fill="rgba(0,119,204,0.12)"/>${texts}</svg>`;
});
showAxisA.addEventListener('click', ()=>{
  axisA.classList.remove('hidden');
  if(!A.members || A.members.length===0){ axisA.innerHTML = `<div class="danger">Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ (${A.base==='Q'?'Ú¯ÙˆÛŒØ§':(A.base==='R'?'Ø­Ù‚ÛŒÙ‚ÛŒ':'Ú¯Ù†Ú¯')}) Ø§Ù…Ú©Ø§Ù†â€ŒÙ¾Ø°ÛŒØ± Ù†ÛŒØ³Øª.</div>`; return; }
  // Ø¨Ø±Ø§ÛŒ N/W/Z: Ù†Ù‚Ø§Ø· Ø±ÙˆÛŒ Ø§Ø¹Ø¯Ø§Ø¯ Ùˆ Ú©Ø§Ø¯Ø± Ø§Ø² Ø§ÙˆÙ„ ØªØ§ Ø¢Ø®Ø±ØŒ Ø§Ú¯Ø± Ø§Ù†ØªÙ‡Ø§ Ø¨Ø§Ø² Ø¨Ø§Ø´Ø¯ Ù†Ø´Ø§Ù† Ø¯Ù‡ÛŒÙ…
  if(['N','W','Z'].includes(A.base)){
    const first = A.members[0], last = A.members[A.members.length-1];
    const meta = A.meta || {};
    let leftOpen=false, rightOpen=false;
    if(meta.type==='lt' && meta.n===last) rightOpen=true;
    if(meta.type==='gt' && meta.n===first) leftOpen=true;
    // Ø±Ø³Ù… Ù†Ù‚Ø§Ø·
    let marks='';
    const span = last - first || 1;
    A.members.forEach(v=>{
      const pos = ((v-first)/span)*90 + 5;
      marks += `<div style="position:absolute;left:${pos}%;top:6px;text-align:center;">â—<div style="font-size:12px">${persian(v)}</div></div>`;
    });
    const leftArrow = leftOpen ? 'â—‚' : '';
    const rightArrow = rightOpen ? 'â–¸' : '';
    axisA.innerHTML = `<div style="position:relative;height:80px;border-top:2px solid #333;padding-top:6px;">
        ${marks}
        <div style="position:absolute;left:5%;right:5%;top:44px;text-align:center;color:#444">${leftArrow} <span style="display:inline-block;border:1px solid #aaa;padding:6px;border-radius:6px;background:#fff">Ø§Ø² ${persian(first)} ØªØ§ ${persian(last)}</span> ${rightArrow}</div>
      </div>`;
    return;
  }
  // Ø¨Ø±Ø§ÛŒ R: Ø§Ú¯Ø± Ø´Ø±Ø· ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨ÙˆØ¯ (equal) Ø¯Ø§ÛŒØ±Ù‡ Ù¾Ø±ØŒ Ø§Ú¯Ø± Ù†Ù‚Ø·Ù‡ Ù…Ø±Ø²ÛŒ Ø¨Ø§Ø² Ø¯Ø§ÛŒØ±Ù‡ Ø®Ø§Ù„ÛŒ Ùˆ Ø¨ÛŒÙ† Ø¢Ù†Ù‡Ø§ Ø®Ø·
  const meta = A.meta || {};
  if(meta.type==='equal'){
    const n = meta.n;
    axisA.innerHTML = `<div style="height:60px;border-top:2px solid #333;position:relative;">
      <div style="position:absolute;left:50%;top:0;transform:translateX(-50%);font-size:18px;">â—</div>
      <div style="position:absolute;left:50%;top:24px;transform:translateX(-50%);font-size:12px">${persian(n)}</div>
    </div>`;
    return;
  }
  if(meta.type==='interval'){
    const a=meta.a,b=meta.b;
    const leftChar = meta.inclusiveLeft? 'â—' : 'â—‹';
    const rightChar = meta.inclusiveRight? 'â—' : 'â—‹';
    axisA.innerHTML = `<div style="height:70px;border-top:2px solid #333;position:relative;">
      <div style="position:absolute;left:20%;top:0">${leftChar}<div style="font-size:12px">${persian(a)}</div></div>
      <div style="position:absolute;left:80%;top:0">${rightChar}<div style="font-size:12px">${persian(b)}</div></div>
      <div style="position:absolute;left:20%;right:20%;top:18px;border-top:2px solid #333"></div>
    </div>`;
    return;
  }
  // fallback:
  axisA.innerHTML = `<div class="muted">Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ÙˆØ±ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ø¨Ù‡ Ø´Ú©Ù„ Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>`;
});

/* Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­Ù„ÛŒ Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ø¹Ù…Ù„ÛŒØ§Øª */
saveLocal.addEventListener('click', ()=>{
  localStorage.setItem('A_data', JSON.stringify(A));
  alert('Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” A Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ (Ù…ÙˆÙ‚Øª). Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ ØµÙØ­Ù‡ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø±ÙˆÛŒØ¯.');
});
goOps.addEventListener('click', ()=>{
  if(!A.base){ alert('Ø§Ø¨ØªØ¯Ø§ Ù…Ø¬Ù…ÙˆØ¹Ù‡ A Ø±Ø§ Ø¨Ø³Ø§Ø².'); return; }
  localStorage.setItem('A_data', JSON.stringify(A));
  window.location.href = 'operations.html';
});

/* Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡: Ù†Ù…ÙˆÙ†Ù‡ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ */
(function init(){ baseA.value='N'; condA.value=''; }):void;
</script>
</body>
</html>
