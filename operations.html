<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ â€” Ø¹Ù…Ù„ÛŒØ§Øª</title>
<style>
  body{font-family:'Vazir', Tahoma, sans-serif;background:#f7fbff;margin:10px}
  .card{background:#fff;padding:16px;border-radius:10px;max-width:980px;margin:10px auto;box-shadow:0 8px 24px rgba(0,0,0,0.06)}
  h1{color:#0077cc}
  label{display:block;margin-top:10px;font-weight:600}
  select,input,button,textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #ccc;margin-top:6px;box-sizing:border-box;font-family:inherit}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  button{background:#0077cc;color:#fff;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
  button.ghost{background:#fff;color:#0077cc;border:1px solid #0077cc}
  .big{background:#ff9800;padding:12px 14px;font-weight:700}
  .box{margin-top:10px;padding:10px;border-radius:8px;background:#eef6ff;direction:ltr}
  .hidden{display:none}
  .danger{color:#b00020}
  svg text{font-size:13px;text-anchor:middle}
  .center{text-align:center}
  .muted{color:#666;font-size:13px;margin-top:8px}
  .kbd{background:#f1f1f1;padding:2px 6px;border-radius:4px;border:1px solid #e6e6e6}
</style>
</head>
<body>
  <div class="card">
    <h1>Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ â€” Ø¹Ù…Ù„ÛŒØ§Øª</h1>

    <div>
      <label>Ù…Ø¬Ù…ÙˆØ¹Ù‡ A (Ø«Ø§Ø¨Øª â€” Ø§Ø² ØµÙØ­Ù‡ Ù‚Ø¨Ù„):</label>
      <div id="displayA" class="box">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ A...</div>
    </div>

    <hr>

    <label>Ø±ÙˆØ´ Ø³Ø§Ø®Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡ B:</label>
    <select id="methodB">
      <option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
      <option value="symbolic">Ù†Ù…Ø§Ø¯ Ø±ÛŒØ§Ø¶ÛŒ</option>
      <option value="members">Ù†ÙˆØ´ØªÙ† Ø§Ø¹Ø¶Ø§</option>
      <option value="known">Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù†Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡</option>
    </select>

    <div id="areaB" class="box">Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ´ØŒ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.</div>

    <label style="margin-top:10px">Ø§Ù†ØªØ®Ø§Ø¨ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨ÛŒÙ† A Ùˆ B:</label>
    <select id="op">
      <option value="union">Ø§Ø¬ØªÙ…Ø§Ø¹ (âˆª)</option>
      <option value="intersection">Ø§Ø´ØªØ±Ø§Ú© (âˆ©)</option>
      <option value="difference">ØªÙØ§Ø¶Ù„ (âˆ’)</option>
      <option value="subset">Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡ (âŠ†)</option>
      <option value="member">Ø¹Ø¶Ùˆ Ø¨ÙˆØ¯Ù† (âˆˆ)</option>
    </select>

    <div class="row" style="margin-top:12px">
      <button id="compute">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ ØªÙˆÙ„ÛŒØ¯ C</button>
      <button id="showMathC" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ù†Ù…Ø§Ø¯ Ø±ÛŒØ§Ø¶ÛŒ C</button>
      <button id="showMembersC" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¶Ø§ÛŒ C</button>
      <button id="showVennC" class="ghost">Ù†Ù…Ø§ÛŒØ´ ÙˆÙ† Ø¨Ø±Ø§ÛŒ C</button>
      <button id="showAxisC" class="ghost">Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ÙˆØ± Ø¨Ø±Ø§ÛŒ C</button>
    </div>

    <div id="resultC" class="box">Ù†ØªÛŒØ¬Ù‡Ù” C Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</div>
    <div id="membersC" class="box hidden"></div>
    <div id="vennC" class="box hidden center"></div>
    <div id="axisC" class="box hidden"></div>

  </div>

<script>
/* Ú©Ù…Ú©ÛŒâ€ŒÙ‡Ø§ */
function persian(s){ return String(s).replace(/[0-9]/g,d=>"Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹"[d]); }
function parseExplicit(txt){ if(!txt) return []; const s=txt.replace(/[{}\\s]/g,''); if(!s) return []; const parts=s.split(','); const out=new Set(); parts.forEach(p=>{ if(/^(-?\\d+)-(-?\\d+)$/.test(p)){ const m=p.match(/^(-?\\d+)-(-?\\d+)$/); const a=parseInt(m[1]), b=parseInt(m[2]); for(let i=Math.min(a,b); i<=Math.max(a,b); i++) out.add(i);} else if(/^(-?\\d+)(\\.\\d+)?$/.test(p)){ out.add(Number(p)); } }); return Array.from(out).sort((a,b)=>a-b); }

/* parsePersianCondition same as sets.html */
function parsePersianCondition(t){
  const s=(t||'').trim().toLowerCase();
  if(!s) return {ok:false};
  let m;
  if(m=s.match(/Ø¨ÛŒÙ†\s*(-?\d+)\s*(?:Ùˆ|ØªØ§)\s*(-?\d+)/)){ const a=Number(m[1]), b=Number(m[2]); return {ok:true,predicate:x=>x>=Math.min(a,b)&&x<=Math.max(a,b),symbolic:`${Math.min(a,b)} \\le x \\le ${Math.max(a,b)}`,meta:{type:'interval',a:Math.min(a,b),b:Math.max(a,b),inclusiveBoth:true}};}
  if(m=s.match(/Ú©ÙˆÚ†Ú©ØªØ±\s*ÛŒØ§\s*Ù…Ø³Ø§ÙˆÛŒ\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x<=n,symbolic:`x \\le ${n}`,meta:{type:'lte',n,inclusive:true}};}
  if(m=s.match(/Ø¨Ø²Ø±Ú¯ØªØ±\s*ÛŒØ§\s*Ù…Ø³Ø§ÙˆÛŒ\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x>=n,symbolic:`x \\ge ${n}`,meta:{type:'gte',n,inclusive:true}};}
  if(m=s.match(/Ú©ÙˆÚ†Ú©ØªØ±\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x< n,symbolic:`x < ${n}`,meta:{type:'lt',n,inclusive:false}};}
  if(m=s.match(/Ø¨Ø²Ø±Ú¯ØªØ±\s*(-?\d+)/)){const n=Number(m[1]);return {ok:true,predicate:x=>x> n,symbolic:`x > ${n}`,meta:{type:'gt',n,inclusive:false}};}
  if(/\bØ²ÙˆØ¬\b/.test(s)) return {ok:true,predicate:x=>Number.isInteger(x)&&x%2===0,symbolic:`x \\text{ Ø²ÙˆØ¬}`,meta:{type:'parity',parity:'even'}};
  if(/\bÙØ±Ø¯\b/.test(s)) return {ok:true,predicate:x=>Number.isInteger(x)&&Math.abs(x%2)===1,symbolic:`x \\text{ ÙØ±Ø¯}`,meta:{type:'parity',parity:'odd'}};
  if(m=s.match(/ØªÙ‚Ø³ÛŒÙ…\s*Ø¨Ø±\s*(\d+)/)){const k=Number(m[1]);return {ok:true,predicate:x=>Number.isInteger(x)&&x%k===0,symbolic:`x \\equiv 0 \\ (mod\\ ${k})`,meta:{type:'div',k}};}
  if(m=s.match(/^(-?\d+)$/)){ const n=Number(m[1]); return {ok:true,predicate:x=>x===n,symbolic:`x = ${n}`,meta:{type:'equal',n}};}
  return {ok:false};
}

/* base samples */
const baseSamples = { N:(l=40)=>Array.from({length:l},(_,i)=>i+1), W:(l=40)=>Array.from({length:l},(_,i)=>i), Z:()=>{const a=[];for(let i=-20;i<=20;i++)a.push(i);return a;}, Q:()=>null, R:()=>null, irr:()=>null };

/* Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ A Ø§Ø² localStorage */
let A = JSON.parse(localStorage.getItem('A_data')||'null');
if(!A) {
  document.getElementById('displayA').innerHTML = '<div class="danger">Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” A Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯. Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ØµÙØ­Ù‡Ù” ØªØ¹Ø±ÛŒÙ A (sets.html) Ø±Ø§ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù‡ Ùˆ A Ø±Ø§ Ø¨Ø³Ø§Ø² Ùˆ Ø³Ù¾Ø³ Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨Ø§Ø² Ú©Ù†.</div>';
} else {
  document.getElementById('displayA').innerHTML = `<div><strong>A =</strong> <span style="direction:ltr">${A.symbolic ? A.symbolic : (A.members ? ('{ ' + A.members.slice(0,20).join(', ') + (A.members.length>20? ', ...':'') + ' }') : '{ ... }')}</span></div>`;
}

/* Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡ */
const methodB = document.getElementById('methodB'), areaB = document.getElementById('areaB');
const op = document.getElementById('op');
const compute = document.getElementById('compute');
const resultC = document.getElementById('resultC'), membersC = document.getElementById('membersC'), vennC = document.getElementById('vennC'), axisC = document.getElementById('axisC');
const showMathC = document.getElementById('showMathC'), showMembersC = document.getElementById('showMembersC'), showVennC = document.getElementById('showVennC'), showAxisC = document.getElementById('showAxisC');

let B = { mode:null, base:null, condText:'', members:null, symbolic:null, meta:null };
let C = { symbolic:null, members:null };

/* Ù†Ù…Ø§ÛŒØ´ ÙØ±Ù… B Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±ÙˆØ´ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ */
methodB.addEventListener('change', ()=>{
  const m = methodB.value; B = { mode:m, base:null, condText:'', members:null, symbolic:null, meta:null };
  areaB.innerHTML = '';
  if(m==='symbolic'){
    areaB.innerHTML = `<label>Ø¹Ø¶Ùˆ Ú©Ø¯Ø§Ù… Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø´Ù†Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡ Ø§Ø³ØªØŸ</label>
      <select id="baseB"><option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ --</option><option value="N">â„•</option><option value="W">ğ•</option><option value="Z">â„¤</option><option value="Q">â„š</option><option value="R">â„</option><option value="irr">Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯</option></select>
      <label style="margin-top:6px">Ø´Ø±Ø· (ÙØ§Ø±Ø³ÛŒ) Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯:</label><input id="condB" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ú©ÙˆÚ†Ú©ØªØ± Ø§Ø² 6 ÛŒØ§ Ø²ÙˆØ¬">
      <div style="margin-top:8px"><button id="previewB">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ B</button></div><div id="previewAreaB" style="margin-top:8px"></div>`;
    document.getElementById('previewB').addEventListener('click', ()=>{
      const base=document.getElementById('baseB').value, cond=document.getElementById('condB').value.trim();
      if(!base){ alert('Ø§Ø¨ØªØ¯Ø§ Ù¾Ø§ÛŒÙ‡Ù” B Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†'); return;}
      const parsed = cond ? parsePersianCondition(cond) : {ok:false};
      B.base=base; B.condText=cond; B.meta=parsed.meta||null;
      B.symbolic = cond ? `B = { x âˆˆ ${base} | ${parsed.symbolic || cond} }` : `B = { x âˆˆ ${base} }`;
      if(; B.members = parsed.ok ? sample.filter(parsed.predicate) : sample; }
      else B.members = null;
      document.getElementById('previewAreaB').innerHTML = `<div><strong>Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´:</strong><div style="direction:ltr;margin-top:6px">${B.symbolic}</div></div>`;
    });
  } else if(m==='members'){
    areaB.innerHTML = `<label>Ø§Ø¹Ø¶Ø§ÛŒ B Ø±Ø§ Ø¯Ø§Ø®Ù„ Ø¢Ú©ÙˆÙ„Ø§Ø¯ ÛŒØ§ Ø¨Ø§ Ú©Ø§Ù…Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù† (Ù…Ø«Ù„Ø§Ù‹: 1,2,3 ÛŒØ§ 2-6)</label>
      <input id="manualB" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1,2,5 ÛŒØ§ 2-6"><div style="margin-top:8px"><button id="previewB2">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ B</button></div><div id="previewAreaB2" style="margin-top:8px"></div>`;
    document.getElementById('previewB2').addEventListener('click', ()=>{
      const txt=document.getElementById('manualB').value.trim();
      const arr=parseExplicit(txt);
      B.mode='members'; B.members=arr; B.base=null; B.symbolic = `B = { ${arr.join(', ')} }`;
      document.getElementById('previewAreaB2').innerHTML = `<div><strong>Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ B:</strong> { ${arr.map(persian).join(', ')} }</div>`;
    });
  } else if(m==='known'){
    areaB.innerHTML = `<label>Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” Ø´Ù†Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡Ù” B Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†:</label>
      <select id="knownB"><option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ --</option><option value="N">â„•</option><option value="W">ğ•</option><option value="Z">â„¤</option><option value="Q">â„š</option><option value="R">â„</option><option value="irr">Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯</option></select>
      <div style="margin-top:8px"><button id="previewB3">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ B</button></div><div id="previewAreaB3" style="margin-top:8px"></div>`;
    document.getElementById('previewB3').addEventListener('click', ()=>{
      const v=document.getElementById('knownB').value;
      if(!v){ alert('Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†'); return; }
      B.mode='known'; B.base=v; B.members =  : null;
      B.symbolic = v==='irr' ? 'B = { Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯ }' : `B = { x âˆˆ ${v} }`;
      document.getElementById('previewAreaB3').innerHTML = `<div><strong>Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´:</strong><div style="direction:ltr;margin-top:6px">${B.symbolic}</div></div>`;
    });
  }
});

/* Ù…Ø­Ø§Ø³Ø¨Ù‡Ù” C Ø¨Ø§ Ø±Ø¹Ø§ÛŒØª Ù‚ÙˆØ§Ù†ÛŒÙ† Ø´Ù…Ø§Ø±Ø´ÛŒ */
compute.addEventListener('click', ()=>{
  resultC.innerHTML=''; membersC.classList.add('hidden'); vennC.classList.add('hidden'); axisC.classList.add('hidden');
  if(!A){ resultC.innerHTML=`<div class="danger">Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” A ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯. Ø§Ø¨ØªØ¯Ø§ Ø¨Ø®Ø´ A Ø±Ø§ Ø¨Ø³Ø§Ø² (sets.html).</div>`; return; }
  if(!methodB.value){ alert('Ø±ÙˆØ´ Ø³Ø§Ø®Øª B Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†'); return; }
  // ØªØ¹ÛŒÛŒÙ† B.members Ø¯Ø± ØµÙˆØ±Øª Ø§Ù…Ú©Ø§Ù†
  let Bm = B.members;
  if(B.mode==='symbolic' && B.base && ['N','W','Z'].includes(B.base) && B.members) Bm = B.members;
  if(B.mode==='known' && ['N','W','Z'].includes(B.base)) Bm = B.members;
  // A.enumerable?
  const A_enum = Array.isArray(A.members) && A.members.length>0;
  const B_enum = Array.isArray(Bm) && Bm.length>0;

  const opv = op.value;

  // Ø¹Ø¶ÙˆÛŒØª: Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¹Ø¯Ø¯ Ù…ÛŒâ€ŒÙ¾Ø±Ø³ÛŒÙ…
  if(opv==='member'){
    const raw = prompt('ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ù„Ø§Ù‹ 3):','3');
    if(raw===null){ resultC.innerHTML='<div class="muted">Ø¹Ù…Ù„ÛŒØ§Øª Ú©Ù†Ø³Ù„ Ø´Ø¯.</div>'; return; }
    const val = Number(raw);
    if(isNaN(val)){ resultC.innerHTML='<div class="danger">Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</div>'; return; }
    // Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¶Ùˆ Ø¨ÙˆØ¯Ù† Ø¯Ø± B: Ø§Ú¯Ø± B_enum Ø¯Ø§Ø±ÛŒÙ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…Ø› ÛŒØ§ Ø§Ú¯Ø± B symbolic Ø¨Ø§ Ø´Ø±Ø· Ø¯Ø§Ø±ÛŒÙ… ØªÙ„Ø§Ø´ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
    let inB = false;
    if(Bm) inB = Bm.includes(val);
    else if(B.mode==='symbolic' && B.condText){
      const parsed = parsePersianCondition(B.condText||B.condText);
      if(parsed.ok) inB = !!parsed.predicate(val);
      else { resultC.innerHTML='<div class="danger">Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø´Ø±Ø· B Ø±Ø§ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ú©Ø±Ø¯.</div>'; return; }
    } else {
      resultC.innerHTML='<div class="danger">Ù‚Ø§Ø¯Ø± Ø¨Ù‡ ØªØ¹ÛŒÛŒÙ† Ø¹Ø¶Ùˆ Ø¨ÙˆØ¯Ù† Ù†ÛŒØ³ØªÙ… (B Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´ Ù†ÛŒØ³Øª).</div>'; return;
    }
    resultC.innerHTML = `<div><strong>Ù†ØªÛŒØ¬Ù‡Ù” Ù†Ù…Ø§Ø¯ÛŒÙ†:</strong> ${persian(val)} âˆˆ B = ${inB?'<strong>Ø¯Ø±Ø³Øª</strong>':'<strong>Ù†Ø§Ø¯Ø±Ø³Øª</strong>'}</div>`;
    C.symbolic = `${persian(val)} âˆˆ B = ${inB}`;
    C.members = null;
    return;
  }

  // Ø²ÛŒØ±Ù…Ø¬Ù…ÙˆØ¹Ù‡: Ø§Ú¯Ø± A Ùˆ B Ø´Ù…Ø§Ø±Ø´â€ŒÙ¾Ø°ÛŒØ± Ø¨Ø§Ø´Ù† ÛŒØ§ Ø´Ø±Ø· B Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ù‡
  if(opv==='subset'){
    if(!A_enum){ resultC.innerHTML = '<div class="danger">Ù‚Ø§Ø¨Ù„ Ù†Ù…Ø§ÛŒØ´ Ù†ÛŒØ³Øª: Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” A Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´ Ù†ÛŒØ³Øª.</div>'; return; }
    if(Bm){
      const allIn = A.members.every(x=>Bm.includes(x));
      resultC.innerHTML = `<div><strong>Ù†ØªÛŒØ¬Ù‡:</strong> A âŠ† B â†’ ${allIn?'<strong>Ø¯Ø±Ø³Øª</strong>':'<strong>Ù†Ø§Ø¯Ø±Ø³Øª</strong>'}</div>`;
      C.symbolic = `A âŠ† B = ${allIn}`; C.members = null; return;
    } else if(B.mode==='symbolic' && B.condText){
      const parsed = parsePersianCondition(B.condText);
      if(!parsed.ok){ resultC.innerHTML = '<div class="danger">Ù‚Ø§Ø¯Ø± Ø¨Ù‡ ØªØ¹ÛŒÛŒÙ† Ù†ÛŒØ³ØªÙ… (Ø´Ø±Ø· B Ù†Ø§Ù…ÙÙ‡ÙˆÙ…).</div>'; return; }
      const allIn = A.members.every(x=>parsed.predicate(x));
      resultC.innerHTML = `<div><strong>Ù†ØªÛŒØ¬Ù‡:</strong> A âŠ† B â†’ ${allIn?'<strong>Ø¯Ø±Ø³Øª</strong>':'<strong>Ù†Ø§Ø¯Ø±Ø³Øª</strong>'}</div>`;
      C.symbolic = `A âŠ† B = ${allIn}`; C.members=null; return;
    } else {
      resultC.innerHTML = '<div class="danger">Ù‚Ø§Ø¯Ø± Ø¨Ù‡ ØªØ¹ÛŒÛŒÙ† Ù†ÛŒØ³ØªÙ…: B Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´ Ù†ÛŒØ³Øª.</div>'; return;
    }
  }

  // Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ (Ø§Ø¬ØªÙ…Ø§Ø¹/Ø§Ø´ØªØ±Ø§Ú©/ØªÙØ§Ø¶Ù„)
  // Ø§Ú¯Ø± Ù‡Ø± Ø¯Ùˆ Ø´Ù…Ø§Ø±Ø´â€ŒÙ¾Ø°ÛŒØ±: Ù…Ø³ØªÙ‚ÛŒÙ… Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù†ÛŒÙ…
  if(A_enum && B_enum){
    const sA=A.members, sB=Bm;
    const setB=new Set(sB);
    const inter = sA.filter(x=>setB.has(x));
    const uni = Array.from(new Set([...sA,...sB])).sort((a,b)=>a-b);
    const diff = sA.filter(x=>!setB.has(x));
    let out=[];
    if(opv==='intersection') out = inter;
    if(opv==='union') out = uni;
    if(opv==='difference') out = diff;
    C.members = out; C.symbolic = opv==='intersection'?'A âˆ© B':opv==='union'?'A âˆª B':'A - B';
    resultC.innerHTML = `<div><strong>Ù†Ù…Ø§Ø¯:</strong> C = ${C.symbolic}</div>`;
    membersC.classList.remove('hidden'); membersC.innerHTML = `<div>{ ${C.members.map(persian).join(', ')} }</div>`;
    return;
  }

  // Ø§Ú¯Ø± A Ø´Ù…Ø§Ø±Ø´â€ŒÙ¾Ø°ÛŒØ± Ùˆ B Ù†Ù…Ø§Ø¯ Ø¨Ø§ Ø´Ø±Ø· Ø¯Ø§Ø±ÛŒÙ…: Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø±ÙˆÛŒ Ø¹Ù†Ø§ØµØ± A Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒÙ…
  if(A_enum && !B_enum && B.mode==='symbolic' && B.condText){
    const parsed = parsePersianCondition(B.condText);
    if(!parsed.ok){ resultC.innerHTML = '<div class="danger">Ù‚Ø§Ø¯Ø± Ø¨Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†ÛŒØ³ØªÙ… (Ø´Ø±Ø· B Ù†Ø§Ù…ÙÙ‡ÙˆÙ…).</div>'; return; }
    let setB_fromA = A.members.filter(x=>parsed.predicate(x)); // intersection of A and B inferred
    let out=[];
    if(opv==='intersection') out = setB_fromA;
    if(opv==='union') out = Array.from(new Set([...A.members, ...setB_fromA])).sort((a,b)=>a-b);
    if(opv==='difference') out = A.members.filter(x=>!setB_fromA.includes(x));
    C.members = out; C.symbolic = opv==='intersection'?'A âˆ© B':opv==='union'?'A âˆª B':'A - B';
    resultC.innerHTML = `<div><strong>Ù†Ù…Ø§Ø¯:</strong> C = ${C.symbolic}</div>`;
    membersC.classList.remove('hidden'); membersC.innerHTML = `<div>{ ${out.map(persian).join(', ')} }</div>`;
    return;
  }

  // Ø§Ú¯Ø± Ù‡Ø± Ø¯Ùˆ Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ ÛŒØ§ ØºÛŒØ±Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´ ÛŒØ§ Ø´Ø±Ø§ÛŒØ· Ù¾ÛŒÚ†ÛŒØ¯Ù‡
  resultC.innerHTML = '<div class="danger">Ù‚Ø§Ø¨Ù„ Ù†Ù…Ø§ÛŒØ´ Ù†ÛŒØ³Øª â€” ÛŒÚ©ÛŒ Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ ÛŒØ§ Ù‡Ø± Ø¯Ùˆ Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ/ØºÛŒØ±Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´ Ø§Ø³Øª (Ù…Ø«Ù„ â„š ÛŒØ§ â„ ÛŒØ§ Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù†Ú¯).</div>';
});

/* Ù†Ù…Ø§ÛŒØ´ Ù†Ù…Ø§Ø¯/Ø§Ø¹Ø¶Ø§/ÙˆÙ†/Ù…Ø­ÙˆØ± C */
showMathC.addEventListener('click', ()=>{
  if(!C.symbolic) { alert('Ø§Ø¨ØªØ¯Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù†'); return; }
  resultC.innerHTML = `<div><strong>Ù†Ù…Ø§Ø¯ Ø±ÛŒØ§Ø¶ÛŒ C:</strong><div style="direction:ltr;margin-top:6px">${C.symbolic}</div></div>`;
});
showMembersC.addEventListener('click', ()=>{
  if(!C.members){ membersC.classList.remove('hidden'); membersC.innerHTML = `<div class="danger">Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ø¶Ø§ Ù…Ù…Ú©Ù† Ù†ÛŒØ³Øª (Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ ÛŒØ§ ØºÛŒØ±Ù‚Ø§Ø¨Ù„â€ŒØ´Ù…Ø§Ø±Ø´).</div>`; return; }
  membersC.classList.remove('hidden'); membersC.innerHTML = `<div>{ ${C.members.map(persian).join(', ')} }</div>`;
});
showVennC.addEventListener('click', ()=>{
  vennC.classList.remove('hidden'); vennC.innerHTML='';
  if(!C.members || C.members.length===0){ vennC.innerHTML = `<div class="danger">Ø§Ù…Ú©Ø§Ù† Ù†Ù…Ø§ÛŒØ´ ÙˆÙ† Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</div>`; return; }
  const members=C.members.slice(0,40); const cx=150,cy=90,r=70;
  let texts=''; const step=360/members.length;
  members.forEach((v,i)=>{ const ang=(step*i-90)*Math.PI/180; const x=cx+r*Math.cos(ang), y=cy+r*Math.sin(ang); texts+=`<text x="${x}" y="${y+4}">${persian(v)}</text>`; });
  vennC.innerHTML = `<svg width="320" height="200"><circle cx="${cx}" cy="${cy}" r="${r}" stroke="#0077cc" fill="rgba(0,119,204,0.12)"/>${texts}</svg>`;
});
showAxisC.addEventListener('click', ()=>{
  axisC.classList.remove('hidden'); axisC.innerHTML='';
  if(!C.members || C.members.length===0){ axisC.innerHTML = `<div class="danger">Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù…Ù…Ú©Ù† Ù†ÛŒØ³Øª.</div>`; return; }
  const arr=C.members.slice().sort((a,b)=>a-b); const first=arr[0], last=arr[arr.length-1]; let marks='';
  const span = last-first||1;
  arr.forEach(v=>{ const pos = ((v-first)/span)*90 +5; marks+=`<div style="position:absolute;left:${pos}%;top:6px;text-align:center;">â—<div style="font-size:12px">${persian(v)}</div></div>`; });
  axisC.innerHTML = `<div style="position:relative;height:80px;border-top:2px solid #333;padding-top:6px;">${marks}<div style="position:absolute;left:5%;right:5%;top:40px;text-align:center;color:#444"><span style="display:inline-block;border:1px solid #aaa;padding:6px;border-radius:6px;background:#fff">Ø§Ø² ${persian(first)} ØªØ§ ${persian(last)}</span></div></div>`;
});
</script>
</body>
</html>
